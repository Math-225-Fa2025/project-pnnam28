---
title: "Sleep Health & Lifestyle Analysis"
author: "Nam Pham"
institute: "Final Project"

output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r load-packages, message=FALSE, include=FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(janitor)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
fig.retina = 3,
dpi = 300,
fig.width = 6,
fig.asp = 0.618,
out.width = "80%",
message = FALSE,
warning = FALSE
)
```

```{r load-data, include=FALSE}
sleep <- read.csv("../../data/Sleep_health_and_lifestyle_dataset.csv") %>%
clean_names() %>%
separate(blood_pressure, into = c("systolic","diastolic"), sep = "/") %>%
mutate(
systolic = as.numeric(systolic),
diastolic = as.numeric(diastolic),
gender = factor(gender),
bmi_category = factor(bmi_category,
levels = c("Underweight","Normal","Overweight","Obese"),
ordered = TRUE),
sleep_disorder = factor(sleep_disorder),
occupation = factor(occupation)
)

model_quality <- lm(
quality_of_sleep ~ sleep_duration +
stress_level +
physical_activity_level +
sleep_disorder,
data = sleep
)
```

```{r, include=FALSE}
style_xaringan(
  title_slide_background_image = "img/confetti.jpg",
  text_font_google   = google_font("Lato"),
  header_font_google = google_font("Montserrat"),
  code_font_google   = google_font("Fira Mono")
)

```

---
class: center, middle

**Overall Goal / Research Question**

"What Lifestyle and Health Factors Affect Sleep Quality?"

How: **stress, sleep duration, sleep disorders (Insomnia, Sleep Apnea, None), physical activity, and BMI** affect sleep quality?

---
class: center, middle

```{r, eval=TRUE,echo=TRUE}
glimpse(sleep)
```

---
class: center, middle

Takeaways

Average sleep duration ≈ 7.1 hours

Sleep quality ≈ 7.3 (on a 1–10 scale)

Stress ranges from 3–8, mean ≈ 5.4

Physical activity and daily steps vary widely

Heart rate around 70 bpm on average


---
class: inverse, center, middle
Sleep Quality by Sleep Disorder (Distribution)
```{r, echo=FALSE}
sleep %>%
ggplot(aes(x = quality_of_sleep, fill = sleep_disorder)) +
geom_density(alpha = 0.45) +
labs(
title = "Distribution of Sleep Quality by Sleep Disorder",
x = "Sleep Quality",
y = "Density",
fill = "Sleep Disorder"
) +
theme_minimal(base_size = 18)
```

---
class: inverse, center, middle
Stress vs Sleep Quality
```{r, echo=FALSE}
sleep %>%
ggplot(aes(x = stress_level, y = quality_of_sleep)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = FALSE, color = "blue") +
labs(
title = "Stress Level vs Sleep Quality",
x = "Stress Level (1–10)",
y = "Sleep Quality (1–10)"
) +
theme_minimal(base_size = 18)
```
---
class: inverse, center, middle
Sleep Quality by BMI
```{r, echo=FALSE}
sleep %>%
group_by(bmi_category) %>%
summarise(mean_quality = mean(quality_of_sleep, na.rm = TRUE)) %>%
ggplot(aes(x = bmi_category, y = mean_quality)) +
geom_segment(aes(x = bmi_category, xend = bmi_category,
y = 0, yend = mean_quality),
color = "darkgreen", linewidth = 1.2) +
geom_point(size = 6, color = "darkgreen") +
labs(
title = "Mean Sleep Quality by BMI Category",
x = "BMI Category",
y = "Mean Sleep Quality"
) +
theme_minimal(base_size = 18)
```

---
class: inverse, center, middle

Modeling Sleep Quality
Regression Model

Model:

quality_of_sleep∼sleep_duration+stress_level+physical_activity_level+sleep_disorder

```{r}
broom::tidy(model_quality)

```
---
class: inverse, center, middle
Key Coefficients

Sleep duration: +0.49

Each additional hour of sleep → ~0.49 increase in sleep quality

Stress level: −0.41

Each 1-point increase in stress → ~0.41 decrease in sleep quality

Physical activity level: +0.0047

Small but statistically significant positive effect

Sleep disorder (vs Insomnia):

None: +0.35

Sleep Apnea: +0.24

Interpretation

People with no sleep disorder and lower stress who sleep longer report the highest sleep quality.
---
class: inverse, center, middle
```{r}
broom::glance(model_quality)
```

Highlights

R² ≈ 0.895 → ~89.5% of variation in sleep quality explained

Residuals are small → predictions close to observed values

Stress and sleep duration are the dominant predictors
---
class: inverse, center, middle

Conclusion
Final Conclusion

Stress level and sleep duration are the strongest predictors of sleep quality.

Higher stress → much worse sleep

Longer sleep → better subjective sleep quality

Sleep disorders, especially insomnia, significantly reduce sleep quality even after controlling for lifestyle factors.

Physical activity has a smaller but positive effect.

BMI and gender show noticeable but weaker associations.

---
class: center, middle

Thank You!